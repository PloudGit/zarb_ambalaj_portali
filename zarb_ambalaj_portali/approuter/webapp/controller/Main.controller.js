sap.ui.define(["com/app/abdiibrahim/zarbambalajportali/controller/BaseController","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","com/app/abdiibrahim/zarbambalajportali/utils/DataModel","com/app/abdiibrahim/zarbambalajportali/utils/ODataController","com/app/abdiibrahim/zarbambalajportali/utils/MainHelper","com/app/abdiibrahim/zarbambalajportali/utils/Mapping","com/app/abdiibrahim/zarbambalajportali/utils/formatter","com/app/abdiibrahim/zarbambalajportali/utils/Excel","sap/ui/model/BindingMode","sap/ui/export/Spreadsheet","sap/m/HBox","sap/m/VBox","sap/m/Text","sap/m/Table"],function(e,t,a,r,i,o,s,p,l,n,d,u,c,m,h){"use strict";return e.extend("com.app.abdiibrahim.zarbambalajportali.controller.Main",{formatters:p,oJSONModel:new a,onInit:function(e){this._Router=this.getOwnerComponent().getRouter();this._Router.getRoute("Main").attachMatched(this._onRouteMatched,this);this._Router.getRoute("supplier").attachMatched(this._onRouteMatchedSupplier,this);this._dataModel=new r;this._oData=new i;this._main=new o;this._mapping=new s;this._excel=new l;this._dataModel.createAllModel(this);this.setMessagePopover(this);var t=this;this._main.setFilterBar(this,"smartFilterBar");this._oData.getTeslimYeriList(this)},_onRouteMatched:function(){var e=this},_onRouteMatchedSupplier:function(e){var t=this;var a=e.getParameter("arguments");var r=a.SupplierNo;if(r){this._main.setUiForSupplier(this,r)}},onAfterRendering:function(){var e=this.byId("mainScrollContainer");if(e){e.scrollTo(0,0,0)}},onExit:function(){},onSearch:function(e){debugger;this._oData.getList(this)},onPressEbeln:function(e){debugger;var t=this;var a=this._main.getIcontabBarSelectedKey(this);var r=e.getSource().getBindingContext("dm");if(!r){return}var i=r.getObject();var o=i.Ebeln;var s=this.getOModel(this,"dm");s.setProperty("/sSelectedEbelnRowData",i);s.setProperty("/detailPopupNote","");var p={};var l=[];p["Ebeln"]=i.Ebeln;p["Ebelp"]=i.Ebelp;p["Menge"]=i.Menge;p["Meins"]=i.Meins;p["Slfdt"]=i.Slfdt;p["Slfdi"]=i.Slfdi;p["Plaka"]=i.Plaka;p["Sevkm"]=i.Sevkm;p["RestSevkm"]="",p["Sofor"]=i.Sofor;p["Tesyr"]=i.Tesyr;l.push(p);s.setProperty("/sSelectedEbelnTableData",l);s.refresh();this._selectedRow=i;this._oData.getPopupInfo(t,i).then(function(){t._orderDetailPopup(a).open()})},_orderDetailPopup:function(e){var t=this;if(!t.OrderDetailPopup){t.OrderDetailPopup=sap.ui.xmlfragment(e,"com.app.abdiibrahim.zarbambalajportali.view.fragments.OrderDetailPopup",t);t.OrderDetailPopup.setModel(t.getView().getModel());t.getView().addDependent(t.OrderDetailPopup);jQuery.sap.syncStyleClass("sapUiSizeCompact",t.getView(),t.OrderDetailPopup)}return t.OrderDetailPopup},onCloseOrderDetailPopup:function(){if(this.OrderDetailPopup){this._oData.getList(this);this.OrderDetailPopup.close()}},onIconTabBarSelect:function(e){this._oData.getList(this)},onApproveOrder:function(e){var t=this;t._main.checkData(t,"AN")},onPressAction:function(e,t){var a=this;var r=a.getOModel(a,"pm");var i=r.getData();if(t==="CONFIRM"){var o=i.detailPopup.currentAction;if(o){a._main.checkData(a,o)}return}if(t==="AC"||t==="RJ"||t==="CN"||t==="CA"||t==="CR"){a._main.checkData(a,t);return}Object.keys(i.detailPopup).forEach(function(e){if(typeof i.detailPopup[e]==="boolean"){i.detailPopup[e]=false}});i.detailPopup.currentAction=t;if(t==="RV"){i.detailPopup.SlfdiVis=true;i.detailPopup.SlfdiEdit=true;i.detailPopup.BtnVisAddNote=false;i.detailPopup.AddNoteArea=true}else if(t==="SE"){i.detailPopup.SevkmVis=true;i.detailPopup.PlakaVis=true;i.detailPopup.SoforVis=true;i.detailPopup.TesyrVis=true;i.detailPopup.BtnVisAddNote=false;i.detailPopup.AddNoteArea=true;i.detailPopup.SevkedVis=true}else if(t==="CV"){i.detailPopup.SlfdiVis=true;i.detailPopup.SlfdiEdit=true;i.detailPopup.BtnVisAddNote=false;i.detailPopup.AddNoteArea=true}i.detailPopup.BtnVisConfirmAction=true;r.refresh()},onConfirmResponse:function(e,t,a){var r=e.getOModel(e,"dm");var i=r.getData();var o=e.getOwnerComponent().getModel("i18n").getResourceBundle();var s=i.sSelectedEbelnTableData[0];var p="";var l="";var n="";if(t==="OK"){var d=i.sSelectedEbelnRowData;var u={Action:a,Ebeln:d.Ebeln,Ebelp:d.Ebelp,Etenr:d.Etenr,Normt:d.Normt,Plaka:s.Plaka,Sofor:s.Sofor,Statu:d.Statu,Tabinfo:d.Tabinfo,Tesyr:s.Tesyr,Slfdi:e.formatters.adjustStartDateForUTC(s.Slfdi),IsSupplier:i["isSupplier"],Lifnr:i["supplierNo"],Sevkm:s.RestSevkm,Desc1:d.Desc1};switch(a){case"AN":var c=i.detailPopupNote?.trim();var m=d.Desc1?.trim()||"";var h=d.Statu;switch(h){case"INIT":p=o.getText("note_type_INIT");break;case"ACCE":p=o.getText("note_type_ACCE");break;case"DELI":p=o.getText("note_type_DELI");break;case"REVF":p=o.getText("note_type_REVF");break;case"REVE":p=o.getText("note_type_REVE");break;case"IPTL":p=o.getText("note_type_IPTL");break;case"AIPT":p=o.getText("note_type_AIPT");break;default:p=o.getText("note_type_DEFAULT")}l=p+" "+c;n=m?m+"\n"+l:l;r.setProperty("/sSelectedEbelnRowData/Desc1",n);r.setProperty("/detailPopupNote","");u.Desc1=n;break;case"AC":case"RJ":var c=i.detailPopupNote?.trim();var m=d.Desc1?.trim()||"";var h=d.Statu;p=o.getText("note_type_REJECT");l=p+" "+c;n=m?m+"\n"+l:l;r.setProperty("/sSelectedEbelnRowData/Desc1",n);r.setProperty("/detailPopupNote","");u.Desc1=n;case"CN":var c=i.detailPopupNote?.trim();var m=d.Desc1?.trim()||"";var h=d.Statu;p=o.getText("note_type_CANCEL");l=p+" "+c;n=m?m+"\n"+l:l;r.setProperty("/sSelectedEbelnRowData/Desc1",n);r.setProperty("/detailPopupNote","");u.Desc1=n;case"CA":case"CR":case"CV":case"RV":var c=i.detailPopupNote?.trim();var m=d.Desc1?.trim()||"";var h=d.Statu;p=o.getText("note_type_REVISE");l=p+" "+c;n=m?m+"\n"+l:l;r.setProperty("/sSelectedEbelnRowData/Desc1",n);r.setProperty("/detailPopupNote","");u.Desc1=n;break;case"SD":case"SE":case"PK":break;default:return}e._oData.approveProcess(e,u)}},onExcelDownload:function(e,t){debugger;var a=this;var r=this.getView();var i=r.getModel("dm");var o=i.getProperty("/"+t)||[];if(!o.length){sap.m.MessageToast.show(this.getView().getModel("i18n").getResourceBundle().getText("noData"));return}a._excel.export({data:o,columns:a._excel.getColumnConfig(a,t,r),fileName:a._excel._getExcelFileName(a,t),sheetName:t},a)}})});
//# sourceMappingURL=Main.controller.js.map